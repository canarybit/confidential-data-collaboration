############################### SHIELDING APPLICATIONS FROM AN UNTRUSTED CLOUD WITH HAVEN ################################

Haven strengthens the security of enclave provided by Intel SGX from a malicious OS and physical attacks such as memory
probes. The cloud provider offers raw resources such as processor cycles, storage and networking but it cannot observe
or modify any user data except what is transmitted over the network. Haven combined with a remote attestation mechanism
gives the user an end-to-end guarantee of application security without trusting the cloud provider. In order to be useful,
an isolation mechanism provided by Intel-SGX must permit interaction with untrusted software or hardware. However at this
point, the interaction between enclave and the untrusted software sometime is vulnerable. Therefore, Haven provides 
shield execution to ensure the confidentiality and integrity of an application and LibOS from an untrusted host, thereby
enabling mutual distrust between host and guest.

Haven builds on Drawbridge, a system supporting low-overhead sandboxing of Windows applications. Haven leverages two core
mechanisms : the picoprocess and library OS. Haven is designed to address two key challenges : protecting from a malicious
host OS such as Iago attacks, and executing existing binaries in an enclave. The architecture of Haven consists of there
main elements : shield module, untrusted interface, and untrusted runtime. Shield module includes private implementations
of typical kernel functionality such as memory management, a file system, and thread synchronization. The untrusted interface
provides 22 calls to execute the following tasks : calls to commit, free and protect specific pages, thread management and
signalling, I/O streams to access untrusted storage and network, and a source of system time. Meanwhile the untrusted runtime
has main task to create the enclave, loading the shield and forwarding calls between the enclave and host OS.

Application deployment and attestation in Haven starts from a user constructs a disk image containing application and LibOS
binaries and data, and then encrypts it symmetrically, retaining the key. The encrypted image and shield binary are sent to
the cloud provider. The shield is not encrypted but its integrity will be verified. The cloud provider establishes a pico-
process, and loads the untrusted runtime, which then creates an enclave and loads the shield module. While the shield is
loaded, the SGX hardware attestation mechanism is used to measure its code and initial state. After initialising itself,
the shield generates a public/private key pair, and then uses its parameters to establish a network connection with the user
this may be a machine physically under the control of the user, or another enclave in the cloud. As a result, Haven's 
performance penalty vs. a VM is 31-54%.